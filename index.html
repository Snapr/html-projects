<!DOCTYPE html>
<html>
    <head>
        <title>PINK</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <style type="text/css" media="screen">



        </style>

        <script src="app/libs/json2.js" type="text/javascript" charset="utf-8"></script> <!-- just in case the browser sucks at JSON -->

        <script src="app/libs/jquery-1.7.1.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="app/libs/jq.cookie.js" type="text/javascript" charset="utf-8"></script>

        <script type="text/javascript" charset="utf-8">
        snapr = {};
        snapr.redirect = '';
        snapr.models = {};
        snapr.views = {};
        snapr.base_url = "http://dev.sna.pr";
        snapr.api_base = snapr.base_url + "/api";
        snapr.access_token_url = snapr.base_url + "/ext/oauth/access_token/";

        // disable jquery-mobile's hash nav so we can replace it with backbone.js
        $(document).bind("mobileinit", function(){
            $.mobile.ajaxEnabled = false;
            $.mobile.pushStateEnabled = false;
            $.mobile.hashListeningEnabled = false;
            $.mobile.defaultPageTransition = 'none';

            $.mobile.fixedToolbars.setTouchToggleEnabled(false);

            // true fixed positioned headers still seem buggy so is disabled
            // $.mobile.touchOverflowEnabled = true;

            // hack to handle cases where we're going directly to a hash
            // we go to the home screen and re-trigger the navigate event
            snapr.redirect = window.location.hash.replace('#','')
            $(document).bind('snaprinit',function(){
                if(snapr.redirect.length){
                    console.warn('redirect to',snapr.redirect)
                    Route.navigate(snapr.redirect, true);
                }
            });

        });
        </script>

        <script src="app/libs/jquery.mobile-1.0/jquery.mobile-1.0.min.js" type="text/javascript" charset="utf-8"></script>

        <script src="app/libs/klass.min.js" type="text/javascript" charset="utf-8"></script> <!-- used by photoswipe -->
        <script src="app/libs/code.photoswipe-3.0.0.min.js" type="text/javascript" charset="utf-8"></script><!-- photoswipe -->

        <script src="app/libs/spin.min.js" type="text/javascript" charset="utf-8"></script>

        <script src="app/libs/underscore-min.js" type="text/javascript" charset="utf-8"></script> <!-- required by backbone -->
        <script src="app/libs/backbone-min.js" type="text/javascript" charset="utf-8"></script> <!-- handles routing, models and sync -->

        <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script> <!-- google maps -->

        <link rel="stylesheet" href="app/libs/jquery.mobile-1.0/jquery.mobile.structure-1.0.min.css" type="text/css" charset="utf-8">
        <!-- <link href="css/theme.less" rel="stylesheet/less" type="text/css">
        <script src="app/libs/less.js" type="text/javascript" charset="utf-8"></script> -->
        <link rel="stylesheet" href="css/theme.css" type="text/css" charset="utf-8">

    </head>
<body class="n-loading">

    <!-- main menu / home page -->
    <div id="home" data-title="Snapr" data-role="page">
        <div data-role="header" data-theme="d">
            <a href="#/search/" data-ajax="false" data-role="button" data-icon="search" data-iconpos="notext"></a>
            <h1>Snapr</h1>
        </div>
        <div data-role="content">
        </div><!-- /content -->
    </div><!-- /page -->

    <script id="home-template" type="text/template">
        <div data-role="content">
            <div class="ui-grid-a">
                <% if (logged_in) {%>
                <div class="ui-block-a">
                    <a class="x-launch-camera" data-role="button">Take a photo</a>
                </div>
                <div class="ui-block-b">
                    <a class="x-launch-photo-library" data-role="button">Choose an existing image</a>
                </div>
                <%}else{%>
                <div class="ui-block-a">
                    <a data-ajax="false" href="#/login/" data-role="button">Log In</a>
                </div>
                <div class="ui-block-b">
                    <a data-ajax="false" href="#/join/" data-role="button">Join</a>
                </div>
                <%}%>
            </div>

            <div class="ui-grid-a">
                <div class="ui-block-a">
                    <a href="#/popular/" data-corners="false" data-shadow="false" data-role="button" data-theme="e" data-ajax="false">Popular</a>
                </div>
                <div class="ui-block-b">
                <% if(logged_in) { %>
                    <a href="#/feed/?username=<%=username%>&list_style=grid" data-corners="false" data-shadow="false" data-role="button" data-theme="c" class="my-snaps" data-ajax="false">My Snaps</a>
                <% }else{ %>
                    <a href="#/feed/" data-corners="false" data-shadow="false" data-role="button" data-theme="c" class="my-snaps" data-ajax="false">Latest</a>
                <% } %>
                </div>
            </div>

            <div class="ui-grid-a">
                <div class="ui-block-a">
                    <a href="#/map/" data-corners="false" data-shadow="false" data-role="button" data-theme="c" data-ajax="false">Map</a>
                </div>
                <div class="ui-block-b">
                    <a href="#/photo-edit/?photo_id=Z4O" data-corners="false" data-shadow="false" data-role="button" data-theme="c" data-ajax="false">Cities</a>
                </div>
            </div>

            <div class="ui-grid-a">
                <div class="ui-block-a">
                <% if(logged_in) { %>
                    <a href="#/logout/"
                    data-ajax="false" data-corners="false" data-shadow="false"
                    data-role="button">Log Out</a>
                <% }else{ %>
                    <a href="#/login/"
                    data-ajax="false" data-corners="false" data-shadow="false"
                    data-role="button">Log In</a>
                <% } %>
                </div>
                <div class="ui-block-b">
                <% if(logged_in) { %>
                    <a href="#/my-account/"
                    data-ajax="false" data-corners="false" data-shadow="false"
                    data-role="button">My Account</a>
                <% }else{ %>
                    <a href="#/join/"
                    data-ajax="false" data-corners="false" data-shadow="false"
                    data-role="button">Join</a>
                <% } %>
                </div>
            </div>
        </div><!-- /content -->
    </script>

    <!-- manage my account settings -->
    <div id="my-account" data-title="My Account" data-add-back-btn="true" data-role="page">
        <div data-role="header">
            <h1>My Account</h1>
        </div>
        <div data-role="content">
            <div class="account-content">
            </div>
        </div>
    </div>

    <!-- template for my-account -->
    <script id="my-account-template" type="text/template">
    <h2>My Account</h2>

    <div data-role="collapsible" data-collapsed="true">
        <h3>Account Name & Email</h3>
        <fieldset data-role="controlgroup">
            <label for="my-account-name">Your Name</label>
            <input type="text" name="my-account-name" id="my-account-name" class="custom"
            value="<%= settings.profile.name %>" />
        </fieldset>
        <fieldset data-role="controlgroup">
            <label for="my-account-email">Email</label>
            <input type="text" name="my-account-email" id="my-account-email" class="custom"
            value="<%= settings.email %>" />
        </fieldset>
        <button data-theme="b" class="save">Save</button>
    </div>

    <div data-role="collapsible" data-collapsed="true">
        <h3>Password</h3>
        <fieldset data-role="controlgroup">
            <label for="my-account-password">New Password</label>
            <input type="password" name="my-account-password" id="my-account-password" class="custom"
            value="" />
        </fieldset>
        <fieldset data-role="controlgroup">
            <label for="my-account-password-verify">Verify</label>
            <input type="password" name="my-account-password-verify" id=" my-account-password-verify" class="custom"
            value="" />
        </fieldset>
        <button data-theme="b" class="save">Save</button>
    </div>

    <div data-role="collapsible" data-collapsed="true">
        <h3>Notifications</h3>
        <legend>Email me when:</legend>
        <fieldset data-role="controlgroup">
            <input type="checkbox" name="my-account-notify-follow" id="my-account-notify-follow" class="custom"
            <% if (settings.profile.notify_when_added_to_group){%> checked="true" <%}%> />
            <label for="my-account-notify-follow">Someone follows me</label>

            <input type="checkbox" name="my-account-notify-favorite" id="my-account-notify-favorite" class="custom"
            <% if (settings.profile.notify_when_image_favorited){%> checked="true" <%}%> />
            <label for="my-account-notify-favorite">Someone favorites one of my images</label>

            <input type="checkbox" name="my-account-notify-comment" id="my-account-notify-comment" class="custom"
            <% if (settings.profile.notify_when_comment_added){%> checked="true" <%}%> />
            <label for="my-account-notify-comment">Someone comments on one of my images</label>

            <input type="checkbox" name="my-account-notify-comment-after" id="my-account-notify-comment-after" class="custom"
            <% if (settings.profile.notify_after_comment){%> checked="true" <%}%> />
            <label for="my-account-notify-comment-after">Someone comments on an image I&apos;ve commented on</label>

            <input type="checkbox" name="my-account-notify-moderation" id="my-account-notify-moderation" class="custom"
            <% if (settings.profile.notify_when_image_moderated){%> checked="true" <%}%> />
            <label for="my-account-notify-moderation">One of my images has been moderated</label>

            <input type="checkbox" name="my-account-notify-snapr" id="my-account-notify-snapr" class="custom"
            <% if (settings.profile.subscribe_to_email_newsletter){%> checked="true" <%}%> />
            <label for="my-account-notify-snapr">Snapr has exciting news</label>
        </fieldset>

        <button data-theme="b" class="save">Save</button>

    </div>

    <div data-role="collapsible" data-collapsed="true">
        <h3>Profile</h3>

        <fieldset data-role="controlgroup" class="my-account-avatar">
            <legend>Avatar</legend>

            <input type="radio" name="my-account-avatar-twitter" id="my-account-avatar-twitter" value="twitter"
            <% if (settings.profile.avatar_type == 'twitter'){ %> checked="true" <% } %> />
            <label for="my-account-avatar-twitter">Twitter</label>

            <input type="radio" name="my-account-avatar-facebook" id="my-account-avatar-facebook" value="facebook"
            <% if (settings.profile.avatar_type == 'facebook'){ %> checked="true" <% } %> />
            <label for="my-account-avatar-facebook">Facebook</label>

            <input type="radio" name="my-account-avatar-gravatar" id="my-account-avatar-gravatar" value="gravatar"
            <% if (settings.profile.avatar_type == 'gravatar'){ %> checked="true" <% } %> />
            <label for="my-account-avatar-gravatar">Gravatar</label>

            <button class="my-account-set-up-gravatar">Set up Gravatar</button>

        </fieldset>

        <fieldset data-role="controlgroup">
            <label for="my-account-profile-name">Your Name</label>
            <input type="text" name="my-account-profile-name" id="my-account-profile-name" class="custom"
            value="<%= settings.profile.name %>" />
        </fieldset>

        <fieldset data-role="controlgroup">
            <label for="my-account-location">Location</label>
            <input type="text" name="my-account-location" id="my-account-location" class="custom"
            value="<%= settings.profile.location %>" />
        </fieldset>

        <fieldset data-role="controlgroup">
            <label for="my-account-website">Website</label>
            <input type="text" name="my-account-website" id="my-account-website" class="custom"
            value="<%= settings.profile.website %>" />
        </fieldset>

        <fieldset data-role="controlgroup">
            <label for="my-account-bio">Bio</label>
            <textarea name="my-account-bio" id="my-account-bio" class="custom"><%= settings.profile.bio %></textarea>
        </fieldset>

        <button data-theme="b" class="my-account-save">Save</button>
    </div>

    <h2>Linked Services</h2>
    <div class="linked-services">
    </div>

    <h2>Add Services</h2>
    <div class="add-services">
    </div>
    </script>

    <!-- list currently linked services and add new ones -->
    <div id="linked-services" data-title="Linked Services" data-add-back-btn="true" data-role="dialog">
        <div data-role="header">
            <h1>Linked Services</h1>
        </div>
        <div data-role="content">
            <div class="services-content">
                <h2 class="tolink-message"></h2>
                <h4>Services to Link</h4>
                <div class="add-services">
                </div>
                <h4>Linked Services</h4>
                <div class="linked-services">
                </div>
            </div>
        </div>
    </div>

    <!-- template for linking a service in #linked-services -->
    <script id="add-linked-service-template" type="text/template">
    <div data-role="collapsible" data-collapsed="true">
    <% switch(provider) { case 'twitter': %>
        <h3>Link Twitter</h3>
        <fieldset data-role="controlgroup">
        </fieldset>
        <button data-inline="true" data-theme="b" class="link-service">Link</button>
    <% break; case 'foursquare': %>
        <h3>Link Foursquare</h3>
        <fieldset data-role="controlgroup">
        </fieldset>
        <button data-inline="true" data-theme="b" class="link-service">Link</button>
    <% break; case 'tumblr': %>
        <h3>Link Tumblr</h3>
        <form class="tumblr-form" action="javascript:void(0)">
            <fieldset data-role="controlgroup">
                <label>Email:<input type="text" id="tumblr-email" /></label>
                <label>Password:<input type="password" id="tumblr-password" /></label>
            </fieldset>
            <input type=submit data-inline="true" data-theme="b" class="link-service" value="Link" />
        </form>
    <% break; case 'facebook': %>
        <h3>Link Facebook</h3>
        <fieldset data-role="controlgroup">
        </fieldset>
        <button data-inline="true" data-theme="b" class="link-service">Link</button>
    <% break; } %>
    </div>
    </script>

    <!-- template for showing a linked service in #linked-services -->
    <script id="linked-service-template" type="text/template">
        <div data-role="collapsible" data-collapsed="true">
        <% switch(service.provider) { case 'twitter': %>
            <h3>Twitter - <%= service.get('username') %></h3>
            <fieldset data-role="controlgroup">

                <button class="twitter-import-profile">Import Profile</button>

                <input type="checkbox" name="twitter-link" id="twitter-link" class="custom"
                <% if(service.get('show_username')){%> checked="true" <%}%> />
                <label for="twitter-link">Link to my profile from Snapr</label>

                <input type="checkbox" name="twitter-tweet" id="twitter-tweet" class="custom"
                <% if(service.get('allow_tweet')){%> checked="true" <%}%> />
                <label for="twitter-tweet">Allow tweets from Snapr</label>

            </fieldset>
        <% break; case 'foursquare': %>
            <h3>Foursquare - <%= service.get('username') %></h3>
            <fieldset data-role="controlgroup">

                <input type="checkbox" name="foursquare-link" id="foursquare-link" class="custom"
                <% if(service.get('show_username')){%> checked="true" <%}%> />
                <label for="foursquare-link">Display my foursquare username</label>

                <input type="checkbox" name="foursquare-checkin" id="foursquare-checkin" class="custom"
                <% if(service.get('allow_checkin')){%> checked="true" <%}%> />
                <label for="foursquare-checkin">Allow checkins from Snapr</label>

            </fieldset>
        <% break; case 'tumblr': %>
            <h3>Tumblr - <%= service.get('username') %></h3>
            <fieldset data-role="controlgroup">

                <input type="checkbox" name="tumblr-link" id="tumblr-link" class="custom"
                <% if(service.get('show_username')){%> checked="true" <%}%> />
                <label for="tumblr-link">Display my Tumblr username</label>

                <input type="checkbox" name="tumblr-post" id="tumblr-post" class="custom"
                <% if(service.get('allow_post')){%> checked="true" <%}%> />
                <label for="tumblr-post">Allow posts from Snapr</label>

            </fieldset>
        <% break; case 'facebook': %>
            <h3>Facebook - <%= service.get('username') %></h3>
            <fieldset data-role="controlgroup">

                <input type="checkbox" name="facebook-link" id="facebook-link" class="custom"
                <% if(service.get('show_profile_link')){%> checked="true" <%}%> />
                <label for="facebook-link">Link to my profile from Snapr</label>

                <input type="checkbox" name="facebook-newsfeed" id="facebook-newsfeed" class="custom"
                <% if(service.get('allow_newsfeed_posts')){%> checked="true" <%}%> />
                <label for="facebook-newsfeed">Allow newsfeed posts from Snapr</label>

                <input type="checkbox" name="facebook-gallery" id="facebook-gallery" class="custom"
                <% if(service.get('allow_gallery_posts')){%> checked="true" <%}%> />
                <label for="facebook-gallery">Allow newsfeed posts from Snapr</label>

            </fieldset>
            <fieldset data-role="controlgroup">

                <label for="facebook-gallery-name">Gallery Name</label>
                <input type="text" name="facebook-gallery-name" id="facebook-gallery-name" class="custom"
                value="<%= service.get('gallery_name') %>" />

            </fieldset>
        <% break; } %>
            <button data-inline="true" class="unlink">Unlink</button><button data-inline="true" data-theme="b" class="save">Save</button>
        </div>
    </script>


    <div id="connect" data-role="page">
        <div data-role="header">
            <h1>Sharing</h1>
            <a href="#/" data-ajax="false" data-role="button" data-icon="delete" data-iconpos="notext"></a>
        </div>
        <div data-role="content">
            <h2>Please link up for sharing:</h2>
            <ul data-role="listview" data-inset="true" data-theme="c">
            </ul>
        </div>
    </div>

    <!-- template for connecting services -->
    <!-- vars provider, status -->
    <!-- wrapped in = <li data-role="fieldcontain"> -->
    <script id="connect-li-template" type="text/template">
    <legend class="provider"><%= provider %></legend>
    <% switch(provider){ case 'tumblr': %>
    <% if(status == "unlinked"){%>
        <form class="tumblr-login" action="javascript:void(0);">
            <label>Email:<input id="connect-tumblr-email" type="text"></label>
            <label>Password:<input id="connect-tumblr-password" type="password"></label>
        </form>
    <%}%>
    <% break; default: %>
    <%}%>
    <div class="PINK-right-button">
    <% switch(status) { case 'ready': %>
        <button data-inline="true" data-theme="b" class="connected">Connected</button>
    <% break; case 'shared': %>
        <button data-inline="true" data-theme="b" class="shared">Shared</button>
    <% break; default:%>
        <button data-inline="true" data-theme="b" class="connect">Connect</button>
    <% }%>
    </div>
    </script>

    <!-- view popular snaps -->
    <div id="popular" data-title="Popular" data-add-back-btn="true" data-role="page">
        <div data-role="header">
            <h1>Popular</h1>

            <div class="right-header-buttons">
                <a href="#/search/" data-ajax="false" data-role="button" data-icon="search" data-iconpos="notext"></a>
                <a href="#/" data-ajax="false" data-role="button" data-icon="home" data-iconpos="notext"></a>
            </div>

            <div data-role="navbar">
                <ul id="popular-timeframe">
                    <li><a id="popular-time-today">Today</a></li>
                    <li><a id="popular-time-week">Week</a></li>
                    <li><a id="popular-time-all" class="ui-btn-active">All</a></li>
                </ul>
            </div>
        </div>
        <div data-role="content">
            <ul class="grid-list">
            </ul>
        </div>
    </div><!-- /page -->

    <script id="thumb-li-template" type="text/template">
        <% _.each( results, function( item, i ){ %>
        <li>
        <a data-ajax="false" href="#/feed/?photo_id=<%= item.get('id') %>&username=<%= item.get('username') %>">
        <img height="100px" width="100px" src="https://s3.amazonaws.com/media-server<%= item.get('server_id') %>.snapr.us/thm2/<%= item.get('secret') %>/<%= item.get('id') %>.jpg" alt="<%= item.get('description') %>" class="thumb-image" />
        </a>
        </li>
        <% }); %>
    </script>


    <!-- show images in a feed view -->
    <!-- <div id="feed" data-role="page" data-add-back-btn="true">
        <div data-role="header">
            <h1>Featured Pics</h1>
        </div>
        <div class="feed-content" data-role="content">
        </div>
        <div class="load-more">
            <button class="more ui-btn-right" data-theme="b">More</button>
        </div>
    </div> -->
    <!-- /page -->

    <div id="feed" data-role="page">
        <div data-role="header">
            <a data-rel="back" data-icon="arrow-l">Back</a>

            <fieldset data-role="controlgroup" data-type="horizontal" class="ui-title feed-view-toggle">
                <input type="radio" name="feed-view-list" id="feed-view-list" value="list">
                <label for="feed-view-list">List</label>
                <input type="radio" name="feed-view-grid" id="feed-view-grid" value="grid">
                <label for="feed-view-grid">Grid</label>
            </fieldset>

            <div class="right-header-buttons">
                <a href="#/search/" data-ajax="false" data-role="button" data-icon="search" data-iconpos="notext"></a>
                <a href="#/" data-ajax="false" data-role="button" data-icon="home" data-iconpos="notext"></a>
            </div>
        </div>
        <div class="feed-content" data-role="content">
            <div class="feed-upload-progress">
                <ul class="feed-upload-list" data-role="listview">
                </ul>
            </div>
            <div class="feed-header">
            </div>
            <ul class="gallery">
            </ul>
        </div>

        <button class="more ui-btn-right">More</button>

    </div><!-- /page -->


    <!-- template for list items within #feed -->
    <script id="feed-li-list-template" type="text/template">
    <li class="feed-li">
        <div>
            <div class="ui-grid-e">
                <div class="ui-block-a">
                    <a data-ajax="false" data-transition="slide" href="#/feed/?username=<%= item.get('username') %>"><img src="http://sna.pr/avatars/<%= item.get('username') %>/" alt="<%= item.get('username') %>" /></a>
                </div>
                <div>
                    <h3><a data-ajax="false" data-transition="slide" href="#/feed/?username=<%= item.get('username') %>"><%= item.get('username') %></a></h3>
                    <a class="goto-map"><%= item.get('location').location %> <%= item.get('date') %></a>
                </div>
            </div>

            <a href="https://s3.amazonaws.com/media-server<%= item.get('server_id') %>.snapr.us/lrg/<%= item.get('secret') %>/<%= item.get('id') %>.jpg" rel="external" class="gallery_link"><img style="width:100%;height:<%= snapr.utils.get_photo_height(item.get('width'), item.get('height'), '#feed .ui-content') %>px;" src="https://s3.amazonaws.com/media-server<%= item.get('server_id') %>.snapr.us/lrg/<%= item.get('secret') %>/<%= item.get('id') %>.jpg" alt="<%= item.get('description') %>" class="thumb-image" /></a>

            <div><%= item.get('description') %></div>

            <div data-role="controlgroup" data-type="horizontal">

                <div data-role="button" data-icon="star" data-inline="true" data-iconpos="notext" class="favorite-button" <% if(item.get('favorite')){ %> data-theme="e" <% }%>></div>

            </div>

            <% if (item.get('location').spot_id){%>
            <div data-role="button" data-inline="true" class="goto-spot">
                @ <%= item.get('location').foursquare_venue_name %>
            </div>
            <%}%>
            <% if (parseInt(item.get('comments')) + parseInt(item.get('favorite_count')) > 0){ %>
            <div data-role="collapsible" data-collapsed="true" class="reactions-button">
                <h3><%= item.get('comments') %> comments and <%= item.get('favorite_count') %> favorites</h3>
                <ul data-inset="true">
                </ul>
            </div>
            <%}else{%>
            <div data-role="collapsible" data-collapsed="true" class="reactions-button" style="display:none;">
                <h3><%= item.get('comments') %> comments and <%= item.get('favorite_count') %> favorites</h3>
                <ul data-inset="true">
                </ul>
            </div>
            <%}%>
            <div data-role="collapsible" data-collapsed="true" class="comment-area">
                <h4>Comment</h4>
                <div>
                    <form action="javascript:void(0);" class="comment-form" accept-charset="utf-8">
                        <textarea name="comment-<%= item.get('id') %>" placeholder="Comment" />
                        <input type="submit" value="Submit" />
                    </form>
                </div>
            </div>

        </div>
    </li>
    </script>

    <script id="feed-li-grid-template" type="text/template">
    <li class="feed-li-grid">
        <a href="https://s3.amazonaws.com/media-server<%= item.get('server_id') %>.snapr.us/lrg/<%= item.get('secret') %>/<%= item.get('id') %>.jpg" rel="external" class="gallery_link"><img src="https://s3.amazonaws.com/media-server<%= item.get('server_id') %>.snapr.us/thm2/<%= item.get('secret') %>/<%= item.get('id') %>.jpg" alt="<%= item.get('description') %>" class="thumb-image" /></a>
    </li>
    </script>

    <script id="feed-li-list-pink-template" type="text/template">
        <div>
            <div class="image-frame">
            <img style="width:100%;height:<%= snapr.utils.get_photo_height(item.get('width'), item.get('height'), '#feed .ui-content') %>px;" src="http://pink.victoriassecret.com/<%= item.get('mobileFilePath') %>" alt="<%= item.get('description') %>" class="main-image" />
            </div>

            <div class="image-caption"><%= item.get('description') %></div>
        </div>
    </script>


    <script id="reaction-li-template" type="text/template">
    <% if(reaction.get('type') == 'comment'){ %>
        <li><a data-ajax="false" href="#/feed/?username=<%= reaction.get('username') %>"><img class="ui-li-icon" src="http://sna.pr/avatars/<%= reaction.get('username') %>" width="16px" height="16px" /><h5><%= reaction.get('username') %>:</h5><p><%= reaction.get('comment') %></p></a></li>
    <% }else{ %>
        <li><a data-ajax="false" href="#/feed/?username=<%= reaction.get('username') %>"><img class="ui-li-icon" src="http://sna.pr/avatars/<%= reaction.get('username') %>" width="16px" height="16px" /><h5><%= reaction.get('username') %> likes this.</h5></a></li>
    <% } %>
    </script>

    <script id="feed-header-template" type="text/template">
    <div class="ui-body ui-body-e">
    <% if (query_data.keywords){ %>
        <p>Search for <span class="search-term"><%= query_data.keywords %></span></p>
    <%}else if (query_data.username){ %>
        <p><%= query_data.username %></p>
    <%}else if (query_data.spot){%>
        <p>Spot ID <%= query_data.spot %></p>
    <%}%>
    </div>
    </script>

    <script id="user-header-template" type="text/template">
    <div class="ui-body ui-body-e ui-grid-b">
        <div class="ui-block-a">
            <a href="#/user/profile/?username=<%= user.get('username') %>" data-ajax="false"><img height="100px" width="100px" src="http://sna.pr/avatars/<%= user.get('username') %>?size=large" alt="<%= user.get('username') %> avatar" /></a>
        </div>
        <div>
            <span><%= user.username %></span>
            <% if (user.get('username') == auth_username){%>
                <button data-inline="true" disabled="true" data-icon="check" data-iconpos="right">That&apos;s Me</button>
            <%}else{%>
                <% if (user.get('relationship').you_follow) {%>
                <button data-inline="true" data-icon="minus" data-iconpos="right" class="unfollow">Unfollow</button>
                <%}else{%>
                <button data-inline="true" data-icon="plus" data-iconpos="right" class="follow">Follow</button>
                <%}%>
            <%}%>
                <div class="ui-grid-b">
                    <div class="ui-block-a"><span><%= user.photo_count %></span><br /><span>Photos</span></div>
                    <div class="ui-block-b">
                        <a href="#/user/followers/?username=<%= user.get('username') %>" data-ajax="false"><span><%= user.get('followers') %></span>
                        <br /><span>Followers</span></a>
                        </div>
                    <div class="ui-block-c">
                        <a href="#/user/following/?username=<%= user.get('username') %>" data-ajax="false"><span><%= user.get('following') %></span>
                        <br /><span>Following</span></a></div>
                </div>
            </div>

        </div>
    </script>

    <script id="feed-li-list-template" type="text/template">
    <li class="feed-li">
        <div>
            <div class="ui-grid-e">
                <div class="ui-block-a">
                    <a data-ajax="false" data-transition="slide" href="#/feed/?username=<%= item.get('username') %>"><img src="http://sna.pr/avatars/<%= item.get('username') %>/" alt="<%= item.get('username') %>" /></a>
                </div>
                <div>
                    <h3><a data-ajax="false" data-transition="slide" href="#/feed/?username=<%= item.get('username') %>"><%= item.get('username') %></a></h3>
                    <a class="goto-map"><%= item.get('location').location %> <%= item.get('date') %></a>
                </div>
            </div>

            <a href="https://s3.amazonaws.com/media-server<%= item.get('server_id') %>.snapr.us/lrg/<%= item.get('secret') %>/<%= item.get('id') %>.jpg" rel="external" class="gallery_link"><img style="width:100%;height:<%= snapr.utils.get_photo_height(item.get('width'), item.get('height'), '#feed .ui-content') %>px;" src="https://s3.amazonaws.com/media-server<%= item.get('server_id') %>.snapr.us/lrg/<%= item.get('secret') %>/<%= item.get('id') %>.jpg" alt="<%= item.get('description') %>" class="thumb-image" /></a>

            <div><%= item.get('description') %></div>

            <div data-role="controlgroup" data-type="horizontal">

                <div data-role="button" data-icon="star" data-inline="true" data-iconpos="notext" class="favorite-button" <% if(item.get('favorite')){ %> data-theme="e" <% }%>></div>

            </div>

            <% if (item.get('location').spot_id){%>
            <div data-role="button" data-inline="true" class="goto-spot">
                @ <%= item.get('location').foursquare_venue_name %>
            </div>
            <%}%>
            <% if (parseInt(item.get('comments')) + parseInt(item.get('favorite_count')) > 0){ %>
            <div data-role="collapsible" data-collapsed="true" class="reactions-button">
                <h3><%= item.get('comments') %> comments and <%= item.get('favorite_count') %> favorites</h3>
                <ul data-inset="true">
                </ul>
            </div>
            <%}else{%>
            <div data-role="collapsible" data-collapsed="true" class="reactions-button" style="display:none;">
                <h3><%= item.get('comments') %> comments and <%= item.get('favorite_count') %> favorites</h3>
                <ul data-inset="true">
                </ul>
            </div>
            <%}%>
            <div data-role="collapsible" data-collapsed="true" class="comment-area">
                <h4>Comment</h4>
                <div>
                    <form action="javascript:void(0);" class="comment-form" accept-charset="utf-8">
                        <textarea name="comment-<%= item.get('id') %>" placeholder="Comment" />
                        <input type="submit" value="Submit" />
                    </form>
                </div>
            </div>

        </div>
    </li>
    </script>

    <script id="feed-li-grid-template" type="text/template">
    <li class="feed-li-grid">
        <a href="https://s3.amazonaws.com/media-server<%= item.get('server_id') %>.snapr.us/lrg/<%= item.get('secret') %>/<%= item.get('id') %>.jpg" rel="external" class="gallery_link"><img src="https://s3.amazonaws.com/media-server<%= item.get('server_id') %>.snapr.us/thm2/<%= item.get('secret') %>/<%= item.get('id') %>.jpg" alt="<%= item.get('description') %>" class="thumb-image" /></a>
    </li>
    </script>

    <!-- https://s3.amazonaws.com/media-server2.snapr.us/thm/f06bfa40d66e45ef8c63f9fecd613fbb/YZJ.jpg -->

    <script id="upload-progress-li-template" type="text/template">
        <a>
            <img class="ui-li-icon" height="16" width="16" src="<%= thumbnail %>" />
            <div class="progress-bar <%= upload_status %>">
                <div class="bar-bg bar">
                </div>
                <div class="bar-prog bar" style="width:<%= percent_complete %>%">
                </div>
            </div>
        </a>
    <% if (percent_complete == 100){ %>
        <a data-icon="forward" data-theme="d" class="processing"></a>
    <% }else{ %>
        <a data-icon="delete" data-theme="d" class="cancel"></a>
    <% } %>
    </script>



    <div id="user-profile" data-add-back-btn="true" data-role="dialog">
        <div data-role="header">
            <h1>User Profile</h1>
        </div>
        <div data-role="content">
            <p>user info</p>
        </div>
    </div>

    <div id="people" data-add-back-btn="true" data-role="page">
        <div data-role="header">
            <h1>People</h1>
        </div>
        <div data-role="content">
            <input type="search" id="people-search" value="" placeholder="Search&hellip;" />
            <ul class="people-list" >
            </ul>
        </div>
    </div>

    <div id="join-snapr" data-add-back-btn="true" data-role="dialog">
        <div data-role="header">
            <h1>Join Snapr</h1>
        </div>
        <div data-role="content">
            <form action="javascript: void(0);" accept-charset="utf-8" id="join-dialog">
                <fieldset data-role="controlgroup">
                    <label for="username">Username</label><input type="text" name="username" placeholder="  " autocapitalize="off" id="join-dialog-username">
                    <label for="password">Password</label><input type="password" name="password" placeholder="  " id="join-dialog-password">
                    <label for="email">Email</label><input type="email" name="email" placeholder="  " id="join-dialog-email">
                </fieldset>
                <fieldset data-role="controlgroup">
                    <legend>I have read and agreed to the <a href="http://sna.pr/terms/" target="_blank" >Snapr Terms of Use</a></legend>
                    <input type="checkbox" name="checkbox-1" id="snapr-tos" class="custom" />
                    <label for="snapr-tos">I agree</label>
                </fieldset>
                <input type="submit" name="login" data-theme="b" value="Join" disabled="true">
            </form>

            <!-- <div data-role="fieldcontain"> -->
            <!-- </div> -->
        </div>
        <div data-role="footer">

        </div>
    </div><!-- /page -->


    <div id="search" data-add-back-btn="true" data-role="dialog">
        <div data-role="header">
            <h1>Search</h1>
        </div>
        <div data-role="content">
            <form action="javascript: void(0);" accept-charset="utf-8" id="search-form">
                <fieldset>
                    <input type="text" placeholder="Place Name&hellip;" autocapitalize="off" id="search-keywords">
                    <select id="search-type">
                        <option value="location">Search Locations</option>
                        <option value="tag">Search Tags</option>
                        <option value="user">Search Users</option>
                    </select>
                    <input type="submit" data-theme="b" value="Search">
                </fieldset>
            </form>

        </div>
    </div><!-- /page -->

    <div id="map" data-add-back-btn="true" data-role="page">
        <div data-role="header">
            <h1>Map</h1>

            <div class="right-header-buttons">
                <a href="#/search/" data-ajax="false" data-role="button" data-icon="search" data-iconpos="notext"></a>
                <a href="#/" data-ajax="false" data-role="button" data-icon="home" data-iconpos="notext"></a>
            </div>

        </div>
        <div id="map-layer" data-role="content">
            <div id="google-map">
            </div>
            <div id="map-disambiguation" data-role="content" data-theme="a" style="
            position: absolute;
            display: none;">
                <h4>Did you mean&hellip;</h4>
                <ul data-role="listview" id="map-disambiguation-list">
                </ul>
                <button id="map-disambituation-cancel">Cancel</button>
            </div>
        </div>
        <div data-role="footer">

            <div class="ui-btn-right">
                <select id="map-filter">
                    <option value="just-one">Just One</option>
                    <option value="just-me">Just Me</option>
                    <option value="following">Following</option>
                    <option value="all">All</option>
                </select>
            </div>
        </div>
    </div><!-- /page -->

    <script id="thumb-template" type="text/template">
    <div class="snaprmappoint">
        <div class="snaprmapthumb">
            <span class="snaprthumbbg"></span>
            <span class="snaprmappin"></span>
            <a data-ajax="false" href="#/feed/?photo_id=<%= photo.id %>" class="clickable"><img src="https://s3.amazonaws.com/media-server<%= photo.server_id %>.snapr.us/thm/<%= photo.secret %>/<%= photo.id %>.jpg" alt="<%= photo.description %>" class="snaprmapthumbimage"></a>
        </div>
    </div>
    </script>

    <script id="flag-template" type="text/template">
        <div class="snaprmappoint" style="display: block; position: absolute; top: 156px; left: 80px; z-index: 100;">
            <div class="snaprmapflag">
                <span class="icon map-flag-icon"></span>
                <span class="flag-detail inactive">
                    <a href="" class="flag-link">
                        <span class="icon spot-icon"></span>
                        <span class="description-text">Foo</span>
                    </a>
                    <span class="base-arrow">
                    </span>
                </span>
            </div>
        </div>
    </script>

    <script id="map-disambiguation-li-template" type="text/template">
    <a data-ajax="false" class="map-link"><%= location.formatted_address %></a>
    </script>

    <!-- pink-hearts iframe -->
    <div id="pink-hearts" data-role="page" data-theme="d" data-add-back-btn="true">
        <div data-role="header">
            <h1>Pink Hearts</h1>
        </div>
        <div class="iframe-content">

        </div>
    </div><!-- /page -->


    <!-- log in as a snapr user (for testing - go to #/login/) -->
    <div id="login" data-add-back-btn="true" data-role="dialog">
        <div data-role="header">
            <h1>Log in</h1>
        </div>
        <div data-role="content">
            <div class="login-message"></div>
            <form action="javascript: void(0);" accept-charset="utf-8" id="login-dialog">
                <fieldset>
                    <label for="username">Username</label><input type="text" name="username" placeholder="  " autocapitalize="off" autocorrect="off" id="login-dialog-username">
                    <label for="password">Password</label><input type="password" name="password" placeholder="  " id="login-dialog-password">
                    <input type="submit" name="login" data-theme="b" value="Log In">
                </fieldset>
            </form>

            <!-- <p>Log in with:</p>
            <div data-role="navbar">
                <ul>
                    <li><a href="#" data-role="button" data-theme="c">Twitter</a></li>
                    <li><a href="#" data-role="button" data-theme="c">Facebook</a></li>
                </ul>
            </div> -->

            <ul data-role="listview" data-theme="c" data-inset="true">
                <li><a href="#/join/" data-ajax="false">Join Snapr</a></li>
                <!-- <li><a href="#">Forgot your username or password?</a></li> -->
            </ul>
        </div>
    </div><!-- /page -->

    <!-- no templates for #login -->


    <!-- upload form for web-based uploading/testing (go to #/upload/) -->
    <div id="upload" data-role="page">
        <div data-role="header">
            <h1>Upload</h1>

            <a href="#/" data-ajax="false" data-role="button" data-icon="home" data-iconpos="notext"></a>

        </div>
        <div data-role="content" data-theme="c">
            <div data-role="fieldcontain">
                <form id="upload-form" action="javascript:void(0);" method="POST" enctype="multipart/form-data">
                    <input type="hidden" name="redirect_uri" id="redirect_uri"/>
                    <input type="hidden" name="device-time" id="device-time"/>
                    <input type="hidden" name="-set-later-" id="_access_token"/>
                    <input type="hidden" name="privacy" id="privacy" value="queued"/>
                    <input type="hidden" name="public_groups" id="public_groups" value="pink-nation-featured"/>
                    <label for="username">Select a photo to upload:</label>
                    <input type="file" name="photo" id="upload-file" />

                    <span class="PINK-text-btn">
                    <input disabled="true" type="submit" value="Upload Snap" id="upload-submit" data-theme="e" />
                    </span>



                </form>
            </div>
        </div>
    </div>

    <!-- no templates for #upload -->


    <!-- upload progress view (layout should match the #photo-edit view exactly) -->
    <div id="uploading" data-role="page">
        <div data-role="header">
            <a class="cancel-upload" data-ajax="false" data-role="button">Cancel</a>
            <h1>Uploading</h1>
        </div>
        <div data-role="content">

        </div>


        </div>

    </div>

    <!-- template for #uploading content attached to upload progress li view -->
    <script id="uploading-template" type="text/template">
       <div class="upload-progress-container">
           <div class="PINK-upload-image upload-image">
               <div class="edit-image PINK-upload-image-thumb">
                   <img src="<%= img_url %>" />
               </div>

               <div class="upload-progress-container PINK-upload-image-info">
               <h2>Looking good!</h2>
               <div class="progress-bar <%= upload_status %>">
                   <div class="bar-bg bar">
                   </div>
                   <div class="bar-prog bar" style="width:<%= percent_complete %>%">
                   </div>
                   <% if(percent_complete < 100){%>
                   <p class="progress-count"><%= percent_complete %>%</p>
                   <%}else{%>
                   <p class="progress-count finishing"></p>
                   <%}%>


               </div>
           </div>
          </div>
    </script>


    <!-- sharing setup / caption view -->
    <div id="photo-edit" data-role="page">
        <div data-role="header">
            <a href="#/" data-ajax="false" data-role="button">Cancel</a>
            <h1>Share It</h1>
        </div>
        <div data-role="content">
        </div>
    </div>

    <!-- template for #photo-edit -->
    <script id="photo-edit-template" type="text/template">
        <form action="javascript: void(0);">
            <div class="PINK-upload-image">
                <div class="edit-image PINK-upload-image-thumb pop-white"></div>
                <div class="PINK-upload-image-info PINK-small-text">
                    <%if ((enter_girl_of_month || tumblr_sharing || facebook_sharing)){%>
                        <p class="share-message"  style="display:none;">Some pictures are too good to keep to yourself! Share this with Pink Nation for a chance to have it featured in our app.</p>
                        <textarea name="description" id="description" placeholder="Caption this!" class="pop-white"></textarea>
                    <%}else{%>
                        <p class="share-message">Some pictures are too good to keep to yourself! Share this with Pink Nation for a chance to have it featured in our app.</p>
                        <textarea name="description" id="description" placeholder="Caption this!" style="display:none;" class="pop-white"></textarea>
                    <%}%>

                </div>
            </div>
            <div data-role="controlgroup" data-type="horizontal" class="sharing-settings">
                <ul data-role="listview" data-inset="true" data-theme="c">
                    <li data-role="fieldcontain">

                            <label for="facebook-sharing">Facebook</label>

                            <div class="PINK-switch">
                                <select name="facebook_feed" id="facebook-sharing" data-role="slider">
                                    <%if (facebook_sharing){%>
                                        <option value="off">Off</option>
                                        <option value="on"  selected="true">On</option>
                                    <%}else{%>
                                        <option value="off"  selected="true">Off</option>
                                        <option value="on">On</option>
                                    <%}%>
                                </select>
                            </div>

                    </li>
                    <li data-role="fieldcontain">
                            <label for="tumblr-sharing">Tumblr</label>

                            <div class="PINK-switch">
                                <select name="tumblr" id="tumblr-sharing" data-role="slider">
                                    <%if (tumblr_sharing){%>
                                        <option value="off">Off</option>
                                        <option value="on"  selected="true">On</option>
                                    <%}else{%>
                                        <option value="off"  selected="true">Off</option>
                                        <option value="on">On</option>
                                    <%}%>
                                </select>
                            </div>
                    </li>
                </ul>
                <ul data-role="listview" data-inset="true" data-theme="c">
                    <li data-role="fieldcontain">

                            <label for="enter-girl-of-month">Send to PINK Nation</label>

                            <div class="ui-block-b PINK-switch">
                                <select name="enter-girl-of-month" id="enter-girl-of-month" data-role="slider">
                                    <%if (enter_girl_of_month){%>
                                        <option value="off">Off</option>
                                        <option value="on"  selected="true">On</option>
                                    <%}else{%>
                                        <option value="off"  selected="true">Off</option>
                                        <option value="on">On</option>
                                    <%}%>
                                </select>
                            </div>
                    </li>
                </ul>
            </div>

            <span class="PINK-text-btn">
                <input type="submit" data-role="button" data-theme="e" class="share" value="Share"
                <%if (!(enter_girl_of_month || tumblr_sharing || facebook_sharing)){%>
                    disabled="true"
                <%}%>
                />
            </span>
        </form>
        <a class="skip">Skip this step &raquo;</a>
    </script>

    <!-- template for .edit-image inside #photo-edit -->
    <script id="photo-edit-image-template" type="text/template">
        <img src="<%= img_url %>" />
    </script>


    <!-- landing page for successful image share/save -->
    <div id="love-it" data-role="page">
        <div data-role="content">
        </div>
    </div>

    <script id="people-li-template" type="text/template">
        <a data-ajax="false" href="#/feed/?username=<%= user.get('username') %>">
            <img src="http://sna.pr/avatars/<%= user.get('username') %>" alt="<%= user.get('username') %>" />
            <h3><%= user.get('username') %></h3>
            <p><span class="photo-count"><%= user.get('photo_count') %></span> photos, <span class="followers"><%= user.get('followers') %></span> followers</p>
        </a>
        <% if (user.get('username') == auth_username){%>
            <a disabled="true" data-icon="check" data-iconpos="right"></a>
        <%}else{%>
            <% if (user.get('relationship').you_follow) {%>
            <a data-icon="minus" data-iconpos="right" class="unfollow"></a>
            <%}else{%>
            <a data-icon="plus" data-iconpos="right" class="follow"></a>
            <%}%>
        <%}%>
    </script>


    <!-- template for #love-it -->
    <script id="love-it-template" type="text/template">
        <div class="PINK-love-it">
            <div class="image-frame">
            <img src="<%= img_url %>" style="height:<%= height %>;" alt="thumbnail" class="main-image">
            </div>
            <h2>Love it!</h2>
            <% if (shared){ %>
            <p>Your pic has been shared and saved<br/> to your phone&rsquo;s library</p>
            <% }else{ %>
                <p>Your pic has been saved to your<br/> phone&rsquo;s library</p>
            <% } %>
        </div>

            <a data-ajax="false" data-theme="b" data-role="button" class="PINK-text-btn x-launch-camera">Take another photo</a>
            <a data-ajax="false" data-theme="b" data-role="button" class="PINK-text-btn x-launch-photo-library">Choose an existing pic</a>
            <a data-ajax="false" data-theme="b" href="#/" data-role="button" class="PINK-text-btn">Pics home</a>

    </script>

    <div id="limbo" data-role="page">
        <!-- <h1>You are in limbo</h1> -->
    </div>

<!-- spinner -->
<div class="n-centered-loader main"><span class="spinner"></span></div>

<!-- end page content and templates -->


<!-- weinre script for remote debugging -->
<!-- <script src="http://localhost:8080/target/target-script-min.js#anonymous"></script> -->

<!-- backbone views -->
<script src="app/views/home.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/login.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/limbo.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/upload.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/uploading.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/photo_edit.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/love_it.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/upload_settings.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/linked_service.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/linked_services.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/connect.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/connect_li.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/feed.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/pink_hearts.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/upload_progress_li.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/feed_list.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/feed_li.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/feed_header.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/map.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/map_disambiguation_li.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/my_account.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/people.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/people_li.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/search.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/thumbs_li.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/popular.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/user_header.js" type="text/javascript" charset="utf-8"></script>
<script src="app/views/user_profile.js" type="text/javascript" charset="utf-8"></script>


<!-- backbone models -->
<script src="app/models/auth.js" type="text/javascript" charset="utf-8"></script>
<script src="app/models/user.js" type="text/javascript" charset="utf-8"></script>
<script src="app/models/user_collection.js" type="text/javascript" charset="utf-8"></script>
<script src="app/models/user_settings.js" type="text/javascript" charset="utf-8"></script>
<script src="app/models/linked_service.js" type="text/javascript" charset="utf-8"></script>
<script src="app/models/photo.js" type="text/javascript" charset="utf-8"></script>
<script src="app/models/photo_collection.js" type="text/javascript" charset="utf-8"></script>
<script src="app/models/pink_photo.js" type="text/javascript" charset="utf-8"></script>
<script src="app/models/pink_photo_collection.js" type="text/javascript" charset="utf-8"></script>
<script src="app/models/comment.js" type="text/javascript" charset="utf-8"></script>
<script src="app/models/favorite.js" type="text/javascript" charset="utf-8"></script>
<script src="app/models/thumb.js" type="text/javascript" charset="utf-8"></script>
<script src="app/models/thumb_collection.js" type="text/javascript" charset="utf-8"></script>
<script src="app/models/reaction_collection.js" type="text/javascript" charset="utf-8"></script>
<script src="app/models/reaction.js" type="text/javascript" charset="utf-8"></script>
<script src="app/snapr.js" type="text/javascript" charset="utf-8"></script>
</body>
</html>